<div class="coursera-layout">
    <div class="coursera-wrapper">
        <div class="header-container flex justify-content-between align-items-center">
            <div class="header-text">
                <h1 class="main-title">{{ mode === 'open' ? 'Questions Catalog' : 'Questions History' }}</h1>
                <p class="sub-title">{{ mode === 'open' ? 'Manage and track all community discussions in real-time.' : 'View all closed questions and their resolution history.' }}</p>
            </div>
            <p-button *ngIf="mode === 'open'" label="CREATE NEW QUESTION" icon="pi pi-plus" size="large" styleClass="btn-coursera-primary"
                routerLink="/question/create">
            </p-button>
            <p-button *ngIf="mode === 'closed'" label="QUESTIONS CATALOG" icon="pi pi-clipboard" size="large" styleClass="btn-coursera-primary"
                routerLink="/question/list">
            </p-button>
        </div>

        <div class="table-card shadow-sm">
            <p-table [value]="recentQuestions" [paginator]="true" [rows]="10"
                [lazy]="true" [totalRecords]="totalQuestions"
                (onLazyLoad)="onPageChange($event)"
                [loading]="loading"
                styleClass="p-datatable-lg p-datatable-coursera-v20" [responsiveLayout]="'scroll'"
                [showCurrentPageReport]="true"
                currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries">

                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: 25%">TOPIC</th>
                        <th style="width: 40%">DESCRIPTION</th>
                        <th style="width: 10%" class="text-center">STATUS</th>
                        <th style="width: 15%">ASSIGNEE</th>
                        <th style="width: 10%" class="text-center">ACTION</th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-q>
                    <tr class="row-hover">
                        <td><span class="topic-title">{{ q.title }}</span></td>
                        <td>
                            <p class="snippet-text">{{ q.content | slice:0:150 }}...</p>
                        </td>
                        <td class="text-center">
                            <p-tag [value]="mode === 'open' ? 'Open' : 'Closed'" 
                                   [styleClass]="mode === 'open' ? 'tag-pill-coursera' : 'tag-pill-closed'"></p-tag>
                        </td>
                        <td>
                            <div class="flex align-items-center">
                                <p-avatar [label]="q.assigneeName?.charAt(0)" size="large" shape="circle"
                                    styleClass="avatar-black"></p-avatar>
                                <span class="assignee-name ms-1">{{ q.assigneeName ? q.assigneeName : 'Unassigned'
                                    }}</span>
                            </div>
                        </td>
                        <td class="text-center">
                            <div *ngIf="mode === 'open'">
                                <p-button label="Detail" icon="pi pi-eye" styleClass="btn-view-detail-primary"
                                    pTooltip="View Detail" tooltipPosition="bottom"
                                    (onClick)="viewDetail(q.id)">
                                </p-button>
                            </div>
                            <div *ngIf="mode === 'closed'" class="kebab-menu-container">
                                <p-button icon="pi pi-ellipsis-h" 
                                    styleClass="btn-kebab-menu"
                                    [rounded]="true"
                                    (onClick)="menu.toggle($event)"
                                    pTooltip="More actions" tooltipPosition="left">
                                </p-button>
                                <p-menu #menu [model]="getMenuItems(q.id)" [popup]="true" 
                                    [appendTo]="'body'"
                                    styleClass="actions-menu-dropdown">
                                </p-menu>
                            </div>
                        </td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>